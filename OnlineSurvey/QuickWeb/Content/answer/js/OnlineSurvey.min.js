function IsMobile(){const n={},t=navigator.platform;return n.win=t.indexOf("Win")==0,n.mac=t.indexOf("Mac")==0,n.x11=t=="X11"||t.indexOf("Linux")==0,n.win||n.mac||n.xll?!1:!0}function optionLabelWidth(){const n=$(".questionnaire_question_item_option_option_label");for(let t=0;t<n.length;t++){const i=n.eq(t),r=i.parent(),u=r.css("width").replace("px","")-40;i.css({cssText:`min-width:${u}px !important`})}}function questionShowHide(){var u,n,i,t,r;const f=$(".questionnaire_question_item_xialacaidan select");for(u="xl,",n=0;n<f.length;n++)u+=f.eq(n).val()+",";for($logicSettingDiv=$("div[hassettinglogicdiv=0],div[hassettinglogicdiv=1]"),n=0;n<$logicSettingDiv.length;n++){const f=$logicSettingDiv.eq(n),e=f.attr("logic").split(",");if(f.attr("hassettinglogicdiv")==0){for(i=!0,t=0;t<e.length;t++)if(r=e[t],$(`input[value=${r}]`).is(":checked")==!1&&u.indexOf(`,${r},`)<=0){i=!1;break}i?f.show():(f.hide(),f.find("input:radio").attr("checked",!1),f.find("input:checkbox").attr("checked",!1),f.find("input[type=text],input[type=number],textarea").val(""))}if(f.attr("hassettinglogicdiv")==1){for(i=!1,t=0;t<e.length;t++)if(r=e[t],$(`input[value=${r}]`).is(":checked")||u.indexOf(`,${r},`)>0){i=!0;break}i?f.show():(f.hide(),f.find("input:radio").attr("checked",!1),f.find("input:checkbox").attr("checked",!1),f.find("input[type=text],input[type=number],textarea").val(""))}}}function changeValidateCode(){$("#yzmimg").attr("src",`/Home/GetValidateCode?id=${(new Date).getTime()}`)}function answerProcess(n){var k,t,e,y,r,i,at,a,d,rt,st,w,v,h,ut,ft,l,ct,b;var lt=$(n),o=lt.attr("data-qid"),et=$(".questionnaire_question_item"),tt=0,s=0;for(k=0;k<et.length;k++)if((t=et.eq(k),t.hasClass("isMustInputDiv")!=!1)&&t.css("display")!="none"){if(e=t.attr("id").replace("questionItem_",""),tt++,t.hasClass("danxuanti")&&(d=t.find(":radio:checked"),d.length==0?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_danxuan_errorInfo").text("请选择"))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_danxuan_errorInfo").text(""))),t.hasClass("duoxuanti")){var it=t.find(":checkbox:checked"),i=t.attr("max"),r=t.attr("min");r!=0&&it.length<r?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_duoxuan_errorInfo").text(`最少选择${r}个`))):i!=0&&it.length>i?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_duoxuan_errorInfo").text(`最多选择${i}个`))):it.length==0?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_duoxuan_errorInfo").text("请选择"))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_duoxuan_errorInfo").text(""))}if(t.hasClass("paixuti")&&(t.find(":checkbox:checked").length!=t.find(":checkbox").length?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_paixu_errorInfo").text("还有没有排序的选项"))):o==e&&(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_paixu_errorInfo").text(""))),t.hasClass("tiankongti")){var p=t.find("input,textarea"),c=p.val(),u=!1,f="";c==""||c==null?(u=!1,f="请填空"):(y=p.attr("data-type"),u=!0,f="",y==3&&(r=p.attr("data-min"),r=parseInt(r),i=p.attr("data-max"),i=parseInt(i),c=parseInt(c),at=p.attr("data-diget"),r!=0||i!=0?(a=/^\d+$/,a.test(c)?c>i||c<r?(u=!1,f=`最小值${r},最大值${i}`):(u=!0,f=""):(u=!1,f="请输入整数")):(u=!0,f="")),y==4&&(a=/(^1[3|4|5|6|7|8]\d{9}$)|(^09\d{8}$)/,a.test(c)?(u=!0,f=""):(u=!1,f="请输入正确的手机号码")),y==5&&(a=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/,a.test(c)?(u=!0,f=""):(u=!1,f="请输入正确的邮箱格式")),y==6&&(a=/^\d{15}(\d{2}[A-Za-z0-9])?$/,a.test(c)?(u=!0,f=""):(u=!1,f="请输入正确的身份证号")),y==7&&(a=/^(http:\/\/){0,1}[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/,a.test(c)?(u=!0,f=""):(u=!1,f="请输入正确的网址")));u?(t.find(".questionnaire_question_item_tiankong_errorInfo").text(""),t.removeClass("errorDiv")):(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_tiankong_errorInfo").text(f)))}if(t.hasClass("juzhenti")){var g=t.attr("juzhenType"),nt=t.attr("col"),ot=t.attr("row");if(g==1&&(d=t.find(":radio:checked").length,d<nt?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_juzhen_errorInfo").text("请完成所有的选择项"))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_juzhen_errorInfo").text(""))),g==2){for(rt=t.find("tr"),v=0,h=0;h<rt.length;h++)st=rt.eq(h),st.find(":checkbox:checked").length>0&&v++;v<nt?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_juzhen_errorInfo").text("请完成所有的选择项"))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_juzhen_errorInfo").text(""))}if(g==3){var ht=nt*ot,w=t.find("input"),v=0;for(h=0;h<w.length;h++)l=w.eq(h).val(),l!=""&&l!=null&&v++;v<ht?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_juzhen_errorInfo").text("请完成所有的输入项"))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_juzhen_errorInfo").text(""))}if(g==4){var ht=nt*ot,r=t.attr("data-min"),i=t.attr("data-max");for(r=parseInt(r),i=parseInt(i),w=t.find("input"),v=0,h=0;h<w.length;h++)l=w.eq(h).val(),ut=parseInt(l),l!=""&&l!=null&&(r==0&&i==0||(r!=0||i!=0)&&ut>=r&&ut<=i)&&v++;v<ht?(s++,o==e&&(t.addClass("errorDiv"),ft="请完成所有的输入项",(r!=0||i!=0)&&(ft=`请完成所有的输入项,最小值${r}最大值${i}`),t.find(".questionnaire_question_item_juzhen_errorInfo").text(ft))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_juzhen_errorInfo").text(""))}}t.hasClass("xialacaidanti")&&(l=t.find("select option:selected").val(),l==0?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_xialacaidan_errorInfo").text("请选择"))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_xialacaidan_errorInfo").text("")));t.hasClass("erjixialacaidanti")&&(l=t.find("select:first option:selected").val(),ct=t.find("select:last option:selected").val(),l==0||ct==0?(s++,o==e&&(t.addClass("errorDiv"),t.find(".questionnaire_question_item_erjixialacaidan_errorInfo").text("请选择"))):(t.removeClass("errorDiv"),t.find(".questionnaire_question_item_erjixialacaidan_errorInfo").text("")))}b=Math.ceil((tt-s)/tt*100);b>100&&(b=100);$("#progressbarDiv").css("width",b+"%").html(b+"%")}var isShowQuestionIndex=$("#form1").attr("data-isShowOptionIndex"),$options,i;for(isShowQuestionIndex==1?$(".questionnaire_question_item_name_index").show():$(".questionnaire_question_item_name_index").hide(),$("input[type=text][data-type=8]").attr("onfocus","WdatePicker({dateFmt: 'yyyy-MM-dd'})"),$("input[type=text][data-type=9]").attr("onfocus","WdatePicker({dateFmt: 'yyyy-MM-dd HH:mm'})"),$options=$(".questionnaire_question_item_option"),i=0;i<$options.length;i++)$options.eq(i).children(".questionnaire_question_item_option_option").last().css("border-bottom","initial");optionLabelWidth();$(window).resize(function(){optionLabelWidth()});$(".firstLevelSelect").change(function(){const r=$(this).val(),n=$(`#secondLevelSelectData_${r}`).val().split(","),t=$(this).next();t.html("");var i="<option value='0'>--请选择--<\/option>";for(let t=0;t<n.length;t++)i+=`<option value='${n[t]}'>${n[t]}</option>`;t.html(i)});$(".paixuti :checkbox").click(function(){var i,n,t;const u=$(this).attr("questionid"),r=$(`#questionItem_${u}`).find(":checkbox");if(i=0,$(this).is(":checked")){for(n=0;n<r.length;n++)t=r.eq(n).val(),t>i&&(i=t);i++;$(this).val(i).prev().text(i)}else{const i=$(this).val();for($(this).val(0).prev().text(""),n=0;n<r.length;n++)t=r.eq(n).val(),t!=0&&t>i&&r.eq(n).val(t-1).prev().text(t-1)}});$("div[hassettinglogicdiv=0],div[hassettinglogicdiv=1]").hide();$(":radio,:checkbox").click(function(){questionShowHide()});$(".questionnaire_question_item_xialacaidan select").change(function(){questionShowHide()});$("input,textarea").click(function(){const n=$(this).attr("data-qid");$(`#questionItem_${n}`).removeClass("errorDiv");$(`#questionItem_${n}`).find(`div[data-qid=${n}]`).text("")});$("select").change(function(){const n=$(this).attr("data-qid");$(`#questionItem_${n}`).removeClass("errorDiv");$(`#questionItem_${n}`).find(`div[data-qid=${n}]`).text("")});$(".validateGetSpan").click(function(){$(this).parent().hide();$(this).parent().next().show();changeValidateCode()});$("#yzmimg").click(function(){changeValidateCode()});$("input,select").change(function(){answerProcess(this)});$("textarea").bind("input propertychange","textarea",function(){answerProcess(this)});$("input").bind("input propertychange","input",function(){answerProcess(this)});$(".btnConfirm").click(function(){var t,y,n,l,r,i,ft,h,p,g,it,v,c,e,nt,k,s,ut;for($questions=$(".questionnaire_question_item"),t=null,y=0;y<$questions.length;y++)if((n=$questions.eq(y),n.hasClass("isMustInputDiv")!=!1)&&n.css("display")!="none"){if(n.hasClass("danxuanti")&&(p=n.find(":radio:checked"),p.length==0?(n.addClass("errorDiv"),n.find(".questionnaire_question_item_danxuan_errorInfo").text("请选择"),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_danxuan_errorInfo").text(""))),n.hasClass("duoxuanti")){var d=n.find(":checkbox:checked"),i=n.attr("max"),r=n.attr("min");r!=0&&d.length<r?(n.addClass("errorDiv"),t==null&&(t=n),n.find(".questionnaire_question_item_duoxuan_errorInfo").text(`最少选择${r}个`)):i!=0&&d.length>i?(n.addClass("errorDiv"),t==null&&(t=n),n.find(".questionnaire_question_item_duoxuan_errorInfo").text(`最多选择${i}个`)):d.length==0?(n.addClass("errorDiv"),t==null&&(t=n),n.find(".questionnaire_question_item_duoxuan_errorInfo").text("请选择")):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_duoxuan_errorInfo").text(""))}if(n.hasClass("paixuti")&&(n.find(":checkbox:checked").length!=n.find(":checkbox").length?(n.addClass("errorDiv"),n.find(".questionnaire_question_item_paixu_errorInfo").text("还有没有排序的选项"),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_paixu_errorInfo").text(""))),n.hasClass("tiankongti")){var a=n.find("input,textarea"),o=a.val(),u=!1,f="";o==""||o==null?(u=!1,f="请填空"):(l=a.attr("data-type"),u=!0,f="",l==3&&(r=a.attr("data-min"),r=parseInt(r),i=a.attr("data-max"),i=parseInt(i),o=parseInt(o),ft=a.attr("data-diget"),r!=0||i!=0?(h=/^\d+$/,h.test(o)?o>i||o<r?(u=!1,f=`最小值${r},最大值${i}`):(u=!0,f=""):(u=!1,f="请输入整数")):(u=!0,f="")),l==4&&(h=/(^1[3|4|5|6|7|8]\d{9}$)|(^09\d{8}$)/,h.test(o)?(u=!0,f=""):(u=!1,f="请输入正确的手机号码")),l==5&&(h=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/,h.test(o)?(u=!0,f=""):(u=!1,f="请输入正确的邮箱格式")),l==6&&(h=/^\d{15}(\d{2}[A-Za-z0-9])?$/,h.test(o)?(u=!0,f=""):(u=!1,f="请输入正确的身份证号")),l==7&&(h=/^(http:\/\/){0,1}[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/,h.test(o)?(u=!0,f=""):(u=!1,f="请输入正确的网址")));u?(n.find(".questionnaire_question_item_tiankong_errorInfo").text(""),n.removeClass("errorDiv")):(n.addClass("errorDiv"),t==null&&(t=n),n.find(".questionnaire_question_item_tiankong_errorInfo").text(f))}if(n.hasClass("juzhenti")){var w=n.attr("juzhenType"),b=n.attr("col"),tt=n.attr("row");if(w==1&&(p=n.find(":radio:checked").length,p<b?(n.addClass("errorDiv"),n.find(".questionnaire_question_item_juzhen_errorInfo").text("请完成所有的选择项"),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_juzhen_errorInfo").text(""))),w==2){for(g=n.find("tr"),c=0,e=0;e<g.length;e++)it=g.eq(e),it.find(":checkbox:checked").length>0&&c++;c<b?(n.addClass("errorDiv"),n.find(".questionnaire_question_item_juzhen_errorInfo").text("请完成所有的选择项"),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_juzhen_errorInfo").text(""))}if(w==3){var rt=b*tt,v=n.find("input"),c=0;for(e=0;e<v.length;e++)s=v.eq(e).val(),s!=""&&s!=null&&c++;c<rt?(n.addClass("errorDiv"),n.find(".questionnaire_question_item_juzhen_errorInfo").text("请完成所有的输入项"),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_juzhen_errorInfo").text(""))}if(w==4){var rt=b*tt,r=n.attr("data-min"),i=n.attr("data-max");for(r=parseInt(r),i=parseInt(i),v=n.find("input"),c=0,e=0;e<v.length;e++)s=v.eq(e).val(),nt=parseInt(s),s!=""&&s!=null&&(r==0&&i==0||(r!=0||i!=0)&&nt>=r&&nt<=i)&&c++;c<rt?(n.addClass("errorDiv"),k="请完成所有的输入项",(r!=0||i!=0)&&(k=`请完成所有的输入项,最小值${r}最大值${i}`),n.find(".questionnaire_question_item_juzhen_errorInfo").text(k),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_juzhen_errorInfo").text(k))}}n.hasClass("xialacaidanti")&&(s=n.find("select option:selected").val(),s==0?(n.addClass("errorDiv"),n.find(".questionnaire_question_item_xialacaidan_errorInfo").text("请选择"),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_xialacaidan_errorInfo").text("")));n.hasClass("erjixialacaidanti")&&(s=n.find("select:first option:selected").val(),ut=n.find("select:last option:selected").val(),s==0||ut==0?(n.addClass("errorDiv"),n.find(".questionnaire_question_item_erjixialacaidan_errorInfo").text("请选择"),t==null&&(t=n)):(n.removeClass("errorDiv"),n.find(".questionnaire_question_item_erjixialacaidan_errorInfo").text("")))}t!=null?t.get(0).scrollIntoView():($(".btnConfirm").attr("disabled","disabled").text("正在提交"),$.post("/Home/Submit",$("#form1").serialize(),function(n){if(n=="ok"){$(".btnConfirm").text("提交成功正在跳转");const n=$("input[name=questionnaireCode]").val();window.location.href=`/Home/GoingResult/${n}`}else $(".btnConfirm").removeAttr("disabled").text("提交"),$("#validateCode").val(""),changeValidateCode(),alert(n)}))});